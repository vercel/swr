# TypeScript

SWR ã¯ TypeScript ã§æ›¸ã‹ã‚ŒãŸã‚¢ãƒ—ãƒªã«ã‚‚å¯¾å¿œã—ã¦ã„ã¦ã€å‹ã®å®‰å…¨æ€§ã‚’ã™ãã«ä½¿ãˆã¾ã™ã€‚

## åŸºæœ¬çš„ãªä½¿ã„æ–¹ [#basic-usage]

ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ã¯ã€SWR ã¯ `key` ã‹ã‚‰ `fetcher` ã®å¼•æ•°ã®å‹ã‚’æ¨æ¸¬ã—ã¾ã™ã€‚ãã®ãŸã‚ã€é©åˆ‡ãªå‹ã‚’è‡ªå‹•çš„ã«è¨­å®šã§ãã¾ã™ã€‚

### useSWR [#useswr]

```typescript
// `key` ã¯ `string` ã«æ¨æ¸¬ã•ã‚Œã¾ã™ã€‚
useSWR('/api/user', key => {})
useSWR(() => '/api/user', key => {})

// `key` ã¯ { a: string; b: { c: string; d: number } } ã¨ã—ã¦æ¨æ¸¬ã•ã‚Œã¾ã™ã€‚
useSWR({ a: '1', b: { c: '3', d: 2 } }, key => {})
useSWR(() => ({ a: '1', b: { c: '3', d: 2 } }), key => {})

// `arg0` ã¯æ–‡å­—åˆ—ã¨ã—ã¦æ¨æ¸¬ã•ã‚Œã¾ã™ã€‚ `arg1` ã¯æ•°å€¤ã¨ã—ã¦æ¨æ¸¬ã•ã‚Œã¾ã™ã€‚
useSWR(['user', 8], ([arg0, arg1]) => {})
useSWR(() => ['user', 8], ([arg0, arg1]) => {})
```

`key` ã¨ `fetcher` ã®å¼•æ•°ã®å‹ã‚’æ˜ç¤ºçš„ã«æŒ‡å®šã™ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™ã€‚

```typescript
import useSWR, { Fetcher } from 'swr'

const uid = '<user_id>'
const fetcher: Fetcher<User, string> = (id) => getUserById(id)

const { data } = useSWR(uid, fetcher)
// `data` ã¯ `User | undefined` ã¨ãªã‚Šã¾ã™ã€‚
```

åŒæ§˜ã«ã€ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ã¯ã€`fetcher` é–¢æ•°å†…ã§æŠ•ã’ã‚‰ã‚Œã‚‹ [ã‚¨ãƒ©ãƒ¼](/docs/error-handling) ã®å‹ã¯ `any` ã§ã™ãŒã€å‹ã‚’æ˜ç¤ºçš„ã«æŒ‡å®šã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

```typescript
const { data, error } = useSWR<User, Error>(uid, fetcher);
// `data` ã¯ `User | undefined` ã¨ãªã‚Šã¾ã™.
// `error` ã¯ `Error | undefined` ã¨ãªã‚Šã¾ã™.
```

### useSWRInfinite [#useswrinfinite]

`swr/infinite` ã®å ´åˆã¨åŒã˜ã‚ˆã†ã«ã€å‹æ¨è«–ã«é ¼ã‚‹ã‹ã€è‡ªåˆ†ã§æ˜ç¤ºçš„ã«å‹ã‚’æŒ‡å®šã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

```typescript
import { SWRInfiniteKeyLoader } from 'swr/infinite'

const getKey: SWRInfiniteKeyLoader = (index, previousPageData) => {
  // ...
}

const { data } = useSWRInfinite(getKey, fetcher)
```

### useSWRSubscription [#useswrsubscription]

* Inline subscribe function and mamually specify the type of `next`  using `SWRSubscriptionOptions`.

```tsx
import useSWRSubscription from 'swr/subscription'
import type { SWRSubscriptionOptions } from 'swr/subscription'

const { data, error } = useSWRSubscription('key', 
  (key, { next }: SWRSubscriptionOptions<number, Error>) => {
  //^ key will be inferred as `string`
  //....
  })
  return {
    data,
    //^ data will be inferred as `number | undefined`
    error
    //^ error will be inferred as `Error | undefined`
  }
}
```

* declare subscribe function using `SWRSubscription`

```tsx
import useSWRSubscription from 'swr/subscription'
import type { SWRSubscription } from 'swr/subscription'

/** 
 * The first generic is Key
 * The second generic is Data
 * The Third generic is Error
 */
const sub: SWRSubscription<string, number, Error> = (key, { next }) => {                         
  //......
}
const { data, error } = useSWRSubscription('key', sub)
```

## ã‚¸ã‚§ãƒãƒªã‚¯ã‚¹ [#generics]

`data` ã®å‹å®šç¾©ã¯ç°¡å˜ã§ã™ã€‚ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ã¯ã€`fetcher` ã®æˆ»ã‚Šå€¤ã®å‹ï¼ˆæº–å‚™ãŒã§ãã¦ã„ãªã„å ´åˆã¯ `undefined`ï¼‰ã‚’ `data` ã®å‹ã¨ã—ã¦ä½¿ç”¨ã—ã¾ã™ãŒã€ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ¼ã¨ã—ã¦æ¸¡ã™ã“ã¨ã‚‚ã§ãã¾ã™ï¼š

```typescript
// ğŸ”¹ A. å‹ä»˜ãã® fetcher ã‚’ä½¿ã†ï¼š
// `getUser` ã¯ `(endpoint: string) => User` ã«ãªã‚Šã¾ã™ã€‚
const { data } = useSWR('/api/user', getUser)

// ğŸ”¹ B. ãƒ‡ãƒ¼ã‚¿å‹ã‚’æŒ‡å®šï¼š
// `fetcher` ã¯ é€šå¸¸ `any` ã‚’è¿”ã—ã¾ã™ã€‚
const { data } = useSWR<User>('/api/user', fetcher)
```

SWR ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã®å‹ã‚’è¿½åŠ ã—ãŸã„å ´åˆã¯ã€ã“ã‚Œã‚‰ã®å‹ã‚’ç›´æ¥ã‚¤ãƒ³ãƒãƒ¼ãƒˆã™ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™ï¼š

```typescript
import useSWR from 'swr'
import type { SWRConfiguration } from 'swr'

const config: SWRConfiguration = {
  fallbackData: "fallback",
  revalidateOnMount: false
  // ...
}

const { data } = useSWR<string[]>('/api/data', fetcher, config)
```

## ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢ã®å‹ [#middleware-types]

ã‚«ã‚¹ã‚¿ãƒ ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢ã«å‹ã‚’è¿½åŠ ã™ã‚‹ã®ã«å½¹ç«‹ã¤ã€ã‚¤ãƒ³ãƒãƒ¼ãƒˆå¯èƒ½ãªè¿½åŠ ã®å‹å®šç¾©ãŒã„ãã¤ã‹ã‚ã‚Šã¾ã™ã€‚

```typescript
import useSWR, { Middleware, SWRHook } from 'swr'

const swrMiddleware: Middleware = (useSWRNext: SWRHook) => (key, fetcher, config) => {
  // ...
  return useSWRNext(key, fetcher, config)
}
```
