import { Callout } from 'nextra-theme-docs'
import Link from 'next/link'

# ì—ëŸ¬ ì²˜ë¦¬

[`fetcher`](/docs/data-fetching) ì•ˆì—ì„œ ì—ëŸ¬ê°€ ë°œìƒí–ˆë‹¤ë©´ hookì— ì˜í•´ `error`ë¡œ ë°˜í™˜ë©ë‹ˆë‹¤.

```js
const fetcher = url => fetch(url).then(r => r.json())

// ...
const { data, error } = useSWR('/api/user', fetcher)
```

fetch í”„ë¡œë¯¸ìŠ¤ê°€ ê±°ë¶€ë˜ë©´ `error` ê°ì²´ê°€ ì •ì˜ë©ë‹ˆë‹¤.

## ìƒíƒœ ì½”ë“œì™€ ì—ëŸ¬ ê°ì²´ [#status-code-and-error-object]

ë•Œë¡œëŠ” APIê°€ ìƒíƒœ ì½”ë“œì™€ í•¨ê»˜ ì—ëŸ¬ ê°ì²´ë¥¼ ë°˜í™˜í•˜ê¸°ë¥¼ ì›í•©ë‹ˆë‹¤.
ëª¨ë‘ í´ë¼ì´ì–¸íŠ¸ì—ê²Œ ìœ ìš©í•©ë‹ˆë‹¤.

`fetcher`ê°€ ë” ë§ì€ ì •ë³´ë¥¼ ë°˜í™˜í•˜ë„ë¡ ì»¤ìŠ¤í„°ë§ˆì´ì§• í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ìƒíƒœ ì½”ë“œê°€ `2xx`ì´ ì•„ë‹ˆë¼ë©´
JSONìœ¼ë¡œ íŒŒì‹±í•  ìˆ˜ ìˆë”ë¼ë„ ì´ë¥¼ ì—ëŸ¬ë¡œ ê°„ì£¼í•©ë‹ˆë‹¤.

```js
const fetcher = async url => {
  const res = await fetch(url)

  // ìƒíƒœ ì½”ë“œê°€ 200-299 ë²”ìœ„ê°€ ì•„ë‹ˆë”ë¼ë„,
  // íŒŒì‹± ì‹œë„ë¥¼ í•˜ê³  ì—ëŸ¬ë¥¼ ë˜ì§‘ë‹ˆë‹¤.
  if (!res.ok) {
    const error = new Error('An error occurred while fetching the data.')
    // ì—ëŸ¬ ê°ì²´ì— ë¶€ê°€ ì •ë³´ë¥¼ ì¶”ê°€í•©ë‹ˆë‹¤.
    error.info = await res.json()
    error.status = res.status
    throw error
  }

  return res.json()
}

// ...
const { data, error } = useSWR('/api/user', fetcher)
// error.info === {
//   message: "You are not authorized to access this resource.",
//   documentation_url: "..."
// }
// error.status === 403
```

<Callout emoji="ğŸ’¡">
  <code>ë°ì´í„°</code>ì™€ <code>ì—ëŸ¬</code>ëŠ” ë™ì‹œì— ì¡´ì¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë”°ë¼ì„œ UIëŠ” ì˜ˆì •ëœ ìš”ì²­ì´ ì‹¤íŒ¨í–ˆìŒì„ ì•Œë©´ì„œë„
  ê¸°ì¡´ ë°ì´í„°ë¥¼ ë³´ì—¬ì¤„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
</Callout>

[ì—¬ê¸°](/examples/error-handling)ì— ì˜ˆì‹œê°€ ìˆìŠµë‹ˆë‹¤.

## ì—ëŸ¬ ì¬ì‹œë„ [#error-retry]

SWRì€ [ì§€ìˆ˜ ë°±ì˜¤í”„ ì•Œê³ ë¦¬ì¦˜](https://en.wikipedia.org/wiki/Exponential_backoff)ë¥¼ ì‚¬ìš©í•´ ì—ëŸ¬ ì‹œ ìš”ì²­ì„ ì¬ì‹œë„í•©ë‹ˆë‹¤.
ì´ ì•Œê³ ë¦¬ì¦˜ì„ ì‚¬ìš©í•˜ë©´ ì—ëŸ¬ë¡œë¶€í„° ì•±ì„ ë¹ ë¥´ê²Œ ë³µêµ¬í•  ìˆ˜ ìˆìœ¼ë©° ë„ˆë¬´ ìì£¼ ì¬ì‹œë„í•˜ì—¬ ë¦¬ì†ŒìŠ¤ë¥¼ ë‚­ë¹„í•˜ì§€ë„ ì•ŠìŠµë‹ˆë‹¤.

[onErrorRetry](/docs/api#options) ì˜µì…˜ì„ í†µí•´ ì´ ë™ì‘ì„ ì˜¤ë²„ë¼ì´ë“œí•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.

```js
useSWR('/api/user', fetcher, {
  onErrorRetry: (error, key, config, revalidate, { retryCount }) => {
    // 404ì—ì„œ ì¬ì‹œë„ ì•ˆí•¨
    if (error.status === 404) return

    // íŠ¹ì • í‚¤ì— ëŒ€í•´ ì¬ì‹œë„ ì•ˆí•¨
    if (key === '/api/user') return

    // 10ë²ˆê¹Œì§€ë§Œ ì¬ì‹œë„í•¨
    if (retryCount >= 10) return

    // 5ì´ˆ í›„ì— ì¬ì‹œë„
    setTimeout(() => revalidate({ retryCount }), 5000)
  }
})
```

ì´ ì½œë°±ì„ ì‚¬ìš©í•˜ë©´ ë‹¤ì–‘í•œ ì¡°ê±´ì„ ê¸°ë°˜ìœ¼ë¡œ ìœ ì—°í•˜ê²Œ ì¬ì‹œë„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. `shouldRetryOnError: false` ì„¤ì •ìœ¼ë¡œ ë¹„í™œì„±í™”í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.

[ì „ì—­ ì„¤ì •](/docs/global-configuration) ì»¨í…ìŠ¤íŠ¸ë¥¼ í†µí•´ ì œê³µí•˜ëŠ” ê²ƒë„ ê°€ëŠ¥í•©ë‹ˆë‹¤.

## ì „ì—­ ì—ëŸ¬ ê¸°ë¡ [#global-error-report]

í•­ìƒ ì»´í¬ë„ŒíŠ¸ ë‚´ì—ì„œ ë°˜ì‘ì ìœ¼ë¡œ `error` ê°ì²´ë¥¼ ì–»ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
í•˜ì§€ë§Œ UIì— [í† ìŠ¤íŠ¸](https://vercel.com/design/toast) ë˜ëŠ” [ìŠ¤ë‚µë°”](https://material.io/components/snackbars)ë¥¼ ë³´ì—¬ì£¼ê±°ë‚˜ [Sentry](https://sentry.io)ì™€ ê°™ì€ ì–´ë”˜ê°€ì— ê¸°ë¡í•˜ê¸° ìœ„í•´ ì—ëŸ¬ë¥¼ ì „ì—­ìœ¼ë¡œ ì²˜ë¦¬í•˜ê¸¸ ì›í•  ê²½ìš°,
[`onError`](/docs/api#options) ì´ë²¤íŠ¸ê°€ ìˆìŠµë‹ˆë‹¤.

```jsx
<SWRConfig value={{
  onError: (error, key) => {
    if (error.status !== 403 && error.status !== 404) {
      // Sentryë¡œ ì—ëŸ¬ë¥¼ ë³´ë‚´ê±°ë‚˜,
      // ì•Œë¦¼ UIë¥¼ ë³´ì—¬ì¤„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
    }
  }
}}>
  <MyApp />
</SWRConfig>
```
